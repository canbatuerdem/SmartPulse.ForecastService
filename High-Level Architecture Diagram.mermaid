flowchart LR
    Client["Client / UI / External System"]
    Api["SmartPulse Forecast API<br/>(ASP.NET Core, Controllers)"]
    Service["Forecast Service<br/>(Application Layer)"]
    Infra["Repository & Event Publisher<br/>(Infrastructure Layer)"]
    Db["SQL Server<br/>(ForecastDb, Temporal Tables)"]
    Mq["RabbitMQ<br/>(position.changed Exchange)"]

    Client --> Api
    Api --> Service
    Service --> Infra

    Infra -->|EF Core<br/>ForecastDbContext| Db
    Infra -->|PositionChangedEvent| Mq
